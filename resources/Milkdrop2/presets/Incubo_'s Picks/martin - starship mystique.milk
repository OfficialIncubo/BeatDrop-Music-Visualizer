MILKDROP_PRESET_VERSION=201
PSVERSION=4
PSVERSION_WARP=3
PSVERSION_COMP=4
[preset00]
fRating=4.000
fGammaAdj=1.980
fDecay=0.500
fVideoEchoZoom=1.000
fVideoEchoAlpha=0.500
nVideoEchoOrientation=3
nWaveMode=6
bAdditiveWaves=1
bWaveDots=0
bWaveThick=1
bModWaveAlphaByVolume=1
bMaximizeWaveColor=0
bTexWrap=1
bDarkenCenter=0
bRedBlueStereo=0
bBrighten=0
bDarken=1
bSolarize=0
bInvert=0
fWaveAlpha=0.001
fWaveScale=2.103
fWaveSmoothing=0.540
fWaveParam=0.380
fModWaveAlphaStart=0.810
fModWaveAlphaEnd=1.400
fWarpAnimSpeed=1.459
fWarpScale=2.007
fZoomExponent=1.00000
fShader=0.000
zoom=0.99990
rot=0.00000
cx=0.500
cy=0.500
dx=0.00000
dy=0.00000
warp=0.01000
sx=0.99990
sy=1.00000
wave_r=0.000
wave_g=0.000
wave_b=0.000
wave_x=0.500
wave_y=0.500
ob_size=0.000
ob_r=1.000
ob_g=0.000
ob_b=0.000
ob_a=1.000
ib_size=0.260
ib_r=0.250
ib_g=0.250
ib_b=0.250
ib_a=0.000
nMotionVectorsX=64.000
nMotionVectorsY=48.000
mv_dx=0.000
mv_dy=0.000
mv_l=1.850
mv_r=0.500
mv_g=0.500
mv_b=0.500
mv_a=0.000
b1n=0.000
b2n=0.000
b3n=0.000
b1x=1.000
b2x=0.300
b3x=1.000
b1ed=0.000
wavecode_0_enabled=0
wavecode_0_samples=142
wavecode_0_sep=0
wavecode_0_bSpectrum=0
wavecode_0_bUseDots=1
wavecode_0_bDrawThick=0
wavecode_0_bAdditive=1
wavecode_0_scaling=0.04505
wavecode_0_smoothing=0.00000
wavecode_0_r=0.000
wavecode_0_g=1.000
wavecode_0_b=0.000
wavecode_0_a=1.000
wave_0_per_frame1=t1=0; t2= 0; t4=0;
wave_0_per_point1=x = rand(1); y = rand(1);;
wavecode_1_enabled=1
wavecode_1_samples=400
wavecode_1_sep=0
wavecode_1_bSpectrum=0
wavecode_1_bUseDots=1
wavecode_1_bDrawThick=0
wavecode_1_bAdditive=1
wavecode_1_scaling=0.89152
wavecode_1_smoothing=0.00000
wavecode_1_r=1.000
wavecode_1_g=0.100
wavecode_1_b=1.000
wavecode_1_a=0.400
wave_1_per_frame1=t1=t2=t3=0;
wave_1_per_point1=trel=time*2;
wave_1_per_point2=j=t1*4;
wave_1_per_point3=k=sin(trel+t1);
wave_1_per_point4=if (k<-.5,
wave_1_per_point5=a=0; 0[j] = rand(1)-.5; 1[j]=rand(1)-.5; 2[j]=max(0.1,rand(1)),
wave_1_per_point6=0);
wave_1_per_point7=x = 0[j]+.5;
wave_1_per_point8=y = 1[j]+.5;
wave_1_per_point9=a = 2[j]*max(k,0)*(reg11>sample);
wave_1_per_point10=t1+=1;
wavecode_2_enabled=0
wavecode_2_samples=22
wavecode_2_sep=0
wavecode_2_bSpectrum=0
wavecode_2_bUseDots=0
wavecode_2_bDrawThick=1
wavecode_2_bAdditive=0
wavecode_2_scaling=0.89152
wavecode_2_smoothing=0.82000
wavecode_2_r=0.000
wavecode_2_g=1.000
wavecode_2_b=1.000
wavecode_2_a=0.400
wavecode_3_enabled=0
wavecode_3_samples=212
wavecode_3_sep=0
wavecode_3_bSpectrum=1
wavecode_3_bUseDots=1
wavecode_3_bDrawThick=0
wavecode_3_bAdditive=1
wavecode_3_scaling=1.00000
wavecode_3_smoothing=0.50000
wavecode_3_r=1.000
wavecode_3_g=0.000
wavecode_3_b=0.000
wavecode_3_a=0.000
wave_3_per_frame1=t1=t2=t4=0;
shapecode_0_enabled=1
shapecode_0_sides=12
shapecode_0_additive=0
shapecode_0_thickOutline=1
shapecode_0_textured=0
shapecode_0_num_inst=190
shapecode_0_x=0.500
shapecode_0_y=0.500
shapecode_0_rad=0.02217
shapecode_0_ang=0.00000
shapecode_0_tex_ang=0.00000
shapecode_0_tex_zoom=1.87512
shapecode_0_r=0.700
shapecode_0_g=0.000
shapecode_0_b=0.000
shapecode_0_a=0.500
shapecode_0_r2=0.000
shapecode_0_g2=0.000
shapecode_0_b2=0.000
shapecode_0_a2=0.200
shapecode_0_border_r=1.000
shapecode_0_border_g=1.000
shapecode_0_border_b=0.000
shapecode_0_border_a=0.000
shape_0_per_frame1=trel=time*.73;
shape_0_per_frame2=j=instance*4;
shape_0_per_frame3=k=sin(trel+instance);
shape_0_per_frame4=if (k<-.5,
shape_0_per_frame5=a=0; 0[j] = rand(1)-.5; 1[j]=rand(1)-.5; 2[j]=max(0.2,rand(1)),
shape_0_per_frame6=0);
shape_0_per_frame7=x = 0[j]*0.8+0.5;
shape_0_per_frame8=y = 1[j]*0.8+0.5;
shape_0_per_frame9=
shape_0_per_frame10=rad = 2[j]*max(k,0)*(reg10*num_inst>instance)*0.05;
shape_0_per_frame11=
shape_0_per_frame12=a2 = max(0,1-2[j])*.5;
shape_0_per_frame13=additive = instance%6>2;
shapecode_1_enabled=0
shapecode_1_sides=8
shapecode_1_additive=0
shapecode_1_thickOutline=0
shapecode_1_textured=0
shapecode_1_num_inst=1
shapecode_1_x=0.440
shapecode_1_y=0.500
shapecode_1_rad=0.53531
shapecode_1_ang=0.00000
shapecode_1_tex_ang=0.00000
shapecode_1_tex_zoom=1.86831
shapecode_1_r=1.000
shapecode_1_g=0.000
shapecode_1_b=0.000
shapecode_1_a=0.500
shapecode_1_r2=0.000
shapecode_1_g2=0.000
shapecode_1_b2=0.000
shapecode_1_a2=0.000
shapecode_1_border_r=1.000
shapecode_1_border_g=0.590
shapecode_1_border_b=0.000
shapecode_1_border_a=0.000
shapecode_2_enabled=0
shapecode_2_sides=4
shapecode_2_additive=0
shapecode_2_thickOutline=1
shapecode_2_textured=0
shapecode_2_num_inst=1
shapecode_2_x=0.500
shapecode_2_y=0.500
shapecode_2_rad=0.08270
shapecode_2_ang=0.00000
shapecode_2_tex_ang=0.00000
shapecode_2_tex_zoom=0.49981
shapecode_2_r=1.000
shapecode_2_g=1.000
shapecode_2_b=1.000
shapecode_2_a=0.000
shapecode_2_r2=1.000
shapecode_2_g2=1.000
shapecode_2_b2=1.000
shapecode_2_a2=0.000
shapecode_2_border_r=0.500
shapecode_2_border_g=1.000
shapecode_2_border_b=0.500
shapecode_2_border_a=0.700
shapecode_3_enabled=0
shapecode_3_sides=12
shapecode_3_additive=1
shapecode_3_thickOutline=0
shapecode_3_textured=0
shapecode_3_num_inst=1
shapecode_3_x=0.700
shapecode_3_y=0.400
shapecode_3_rad=0.10937
shapecode_3_ang=0.00000
shapecode_3_tex_ang=0.62832
shapecode_3_tex_zoom=2.99675
shapecode_3_r=0.000
shapecode_3_g=0.500
shapecode_3_b=0.000
shapecode_3_a=0.500
shapecode_3_r2=0.000
shapecode_3_g2=0.000
shapecode_3_b2=0.000
shapecode_3_a2=0.000
shapecode_3_border_r=0.500
shapecode_3_border_g=0.500
shapecode_3_border_b=0.500
shapecode_3_border_a=0.000
per_frame_init_1=i=0; loop (5000,i[0]=0; gmem[i]=0; i+=1;);
per_frame_init_2=octaves=3; minbpm=75; maxbpm=200; nres_oct=60; 
per_frame_init_3=nres_extra=nres_oct/log(2)*log(maxbpm/minbpm/2);
per_frame_init_4=nres=nres_oct*octaves+nres_extra;
per_frame_init_5=bstep = log(2)/nres_oct;
per_frame_init_6=nres_out = ceil(nres_oct+nres_extra); //int is necessary !
per_frame_init_7=
per_frame_init_8=maxind = 40;
per_frame_init_9=i=0;
per_frame_init_10=loop (nres,
per_frame_init_11= //precalculate BPM
per_frame_init_12=  (8*i)[3]=minbpm*exp(i*bstep); 
per_frame_init_13= //precalculate weighting
per_frame_init_14=  if (i<=nres_out,(8*i)[4]=min(2,1+sin($pi*i/nres_out)*3)/2,0);; 
per_frame_init_15=i+=1); 
per_frame_init_16=
per_frame_init_17=tmov = 522; speed=1; BPMTime = rand(1000);
per_frame_init_18=trel1a=rand(10);
per_frame_init_19=trel1b=rand(10);
per_frame_init_20=trel2=rand(10);
per_frame_init_21=
per_frame_init_22=
per_frame_1=//Martin/Nitorami - DFT based BPM identification
per_frame_2=dec_m=exp(-2*dt);
per_frame_3=vol=2*bass_att+mid_att+treb_att;
per_frame_4=vol_ = vol_*dec_m + vol*(1-dec_m);
per_frame_5=
per_frame_6=dt=1/fps; 
per_frame_7=tcorr = (dt - dt_);
per_frame_8=dt_= dt;
per_frame_9=treal += dt + tcorr*38;
per_frame_10=exc=vol;
per_frame_11=d0= exp(-1.5*dt);
per_frame_12=i=0; avg = 0;
per_frame_13=loop (nres,
per_frame_14=  n = 8*i;
per_frame_15=  w = 2*$pi/60*n[3];
per_frame_16=  d = 1-dt*w*0.013; 
per_frame_17=  arg = treal*w + tcorr*15000;
per_frame_18=  n[1] = n[1]*d +exc*cos(arg)*(1-d); 
per_frame_19=  n[2] = n[2]*d +exc*sin(arg)*(1-d); 
per_frame_20=  if (i<nres_out, 
per_frame_21=    n2 = 8*(i+nres_oct);
per_frame_22=    n4 = 8*(i+nres_oct*2);
per_frame_23=    sum = sqrt (sqr(n[1])+sqr(n[2]) + sqr(n2[1])+sqr(n2[2]) + sqr(n4[1])+sqr(n4[2]));
per_frame_24=    avg += sum;
per_frame_25=    n[0]= n[0]*d0+sum*(1-d0)*n[4];
per_frame_26=    if (n[0]>(8*promax)[0], promax=max(2,min(nres_out-2,i));,0); 
per_frame_27=  ,0);
per_frame_28=i += 1;);
per_frame_29=avg_ = avg_*d0 + (1-d0)*avg/nres_out;
per_frame_30=
per_frame_31=m8 = 8*maxind;
per_frame_32=wait += abs(m8[0]-(8*promax)[0])*dt*100; 
per_frame_33=if (wait>abs(promax-maxind)*80/nres_oct, maxind=promax; wait = 0,0);
per_frame_34=
per_frame_35=//OUTPUT
per_frame_36=BPM  = m8[3]; // BPM in nres_out discrete steps
per_frame_37=BPMtime += BPM/60*dt*4;
per_frame_38=d=exp(-2*dt);
per_frame_39=quali= quali*d + (1-d)*min (2.5,max(0,m8[0]*2.2));
per_frame_40=
per_frame_41=speed = speed*d + (1-d)*(BPM+50)/120;
per_frame_42=
per_frame_43=d=1-dt*.3;
per_frame_44=if (frame%4==0,
per_frame_45=r1 = max(0,min(1, r1*d + (1-d)*(rand(1)*10-4.5)));
per_frame_46=r2 = max(0,min(1, r2*d + (1-d)*(rand(1)*10-4.5)));
per_frame_47=,0);
per_frame_48=
per_frame_49=trel1a+=r1*speed*0.2*dt;
per_frame_50=trel1b+=r2*speed*0.2*dt;
per_frame_51=trel2+= r2*sin(trel1a)*0.13*dt;
per_frame_52=rott  = trel2;
per_frame_53=q1 = cos(rott);
per_frame_54=q2 = sin(rott);
per_frame_55=q3 = -q2;
per_frame_56=q4 = q1;
per_frame_57=q5 = rott;
per_frame_58=tmov += speed*0.03*dt;
per_frame_59=q6 = tmov;
per_frame_60=q7=speed*500;
per_frame_61=zoom_ = 2;
per_frame_62=q8 = zoom_;
per_frame_63=
per_frame_64=q10=BPMtime;
per_frame_65=q11 =  0.002*max(0,quali)* min(1,max(0,1+2*sin(BPMTime*$pi/32/2)))*(2+mid_att);
per_frame_66=q13 = sin((time+BPMTime)/120)*0.3 + 0.6;
per_frame_67=
per_frame_68=posx = 0.15*sin(trel1a);
per_frame_69=posy = 0.15*sin(trel1b*1.32);
per_frame_70=q15=posx;
per_frame_71=q16=posy;
per_frame_72=
per_frame_73=reg10 = max(0,0.75+sin(trel1a*2)); //num shapes
per_frame_74=reg11 = max(0,0.75+sin(trel1b*.931)); //num dots
per_frame_75=q20 = 0.3 + 0.2*sin(trel1a*2.51); //warp red ch.
per_frame_76=q21 = (0.5 + 0.4*sin(trel1b*0.95))*0.08; //comp struc
per_frame_77=reg32 = aspecty;
per_frame_78=monitor = q20;
warp_1=`sampler sampler_pw_noise_lq;
warp_2=`static const float2 hor = texsize.zw*float2(4,0);
warp_3=`static const float2 ver = texsize.zw*float2(0,4);
warp_4=`
warp_5=`float2 uv1,uv2,dz;
warp_6=`float3 dx,dy;
warp_7=`#define sat saturate
warp_8=`
warp_9=`float3 cloud (float2 uv_in) {
warp_10=`return (-.0+.05/length(uv_in));} 
warp_11=`
warp_12=`float3 noise (float2 uvi, float zv)
warp_13=`{
warp_14=`  float3 n1 = tex3D(sampler_noisevol_hq,float3 (uvi,zv))+
warp_15=`              tex3D(sampler_noisevol_hq,float3 (uvi*3,zv*2))/2+
warp_16=`              tex3D(sampler_noisevol_hq,float3 (uvi*9,zv*5))/4-0.87;
warp_17=`      return n1;
warp_18=`}
warp_19=`
warp_20=`shader_body {
warp_21=`uv1 = (uv-.5);
warp_22=`dx = GetPixel(uv+hor) - GetPixel(uv-hor);
warp_23=`dy = GetPixel(uv+ver) - GetPixel(uv-ver);
warp_24=`
warp_25=`dz = float2 (dx.g,dy.g);
warp_26=`ret.g = lerp (cloud(uv1+noise(uv1,time*0.017)*.25)*0.75,GetPixel(uv+-.01*dz).g,0.95) - 0.004;
warp_27=`dz = float2 (dx.r,dy.r);
warp_28=`uv1*=0.5;
warp_29=`ret.r = lerp (cloud(uv1+noise(uv1,time*0.022)*0.5)*q20,GetPixel(uv-.01*dz).r,0.9) - 0.004;
warp_30=`
warp_31=`float varea = sat(10-20*max(abs(uv.x-.5),abs(uv.y-.5)));
warp_32=`ret*=varea;
warp_33=`
warp_34=`}
comp_1=`#define sat saturate
comp_2=`static const float zoom = q8*aspect.y, T = q6,speed=q7,  trails = 24, 
comp_3=`                   BPMtime=q10, vb=q11, zz=q13;
comp_4=`static const float2 pos = float2 (q15,q16);
comp_5=`sampler sampler_pw_noise_lq;
comp_6=`
comp_7=`float xlen (float2 uvi)
comp_8=`{ return abs (max(abs(uvi.x),abs(uvi.y))-0.03);  
comp_9=`return abs (length (uvi)-0.01);}
comp_10=`
comp_11=`shader_body{
comp_12=`  float mask = 0, fog=0, trail = 0;
comp_13=`  float2 uv1 = (uv_orig-0.5)*aspect.xy + pos;
comp_14=`  float2 p, q = mul (uv1, float2x2(_qa))/zoom, t=0, uvt;
comp_15=`  float3 S = 0, C = float3(1, 2, 3), col, scr, scm;
comp_16=`  for (int i = 0; i < trails; i++)
comp_17=`  {
comp_18=`    float j=i/trails; 
comp_19=`    p = q* (1-zz*j);
comp_20=`    p+= 0.03* sin (pow(i+1.,float2(17,23)/371)*T)*float2(1,3);
comp_21=`    mask = max(mask,sat(10-300*max(abs(p.x),.75*abs(p.y))));
comp_22=`    col =  (cos(C*14*cos(i))+1)*(1+roam_cos);
comp_23=`
comp_24=`    uvt = p + float2(j,0); 
comp_25=`    scr = tex2D(sampler_pw_noise_lq, frac(.2*uvt));
comp_26=`
comp_27=`    uvt += float2(T*.1,T*(1+j));  
comp_28=`    scm = tex2D(sampler_main, 1.5*uvt.yx/aspect.xy);
comp_29=`
comp_30=`    trail = 1 / length (p / (float2(1,scm.r*16)));
comp_31=`    trail += q21*mask*scr.r / length (p / (float2(2,128*scr.g)));
comp_32=`    S += trail *   0.005 * col;
comp_33=`
comp_34=`    S += vb/length(p)* (sat(1-pow((BPMtime)%trails-i,2)) +
comp_35=`                       sat(1-pow((BPMtime*2)%trails-i,2))*2*col);
comp_36=`
comp_37=`   fog += scm.g* abs(p.x);
comp_38=`   S+= scm.g*0.7;
comp_39=` }
comp_40=` ret = sat(q.x)*(C-1)/2  + pow(S,1.5)/trails;
comp_41=` ret = 1-exp (-1.5*ret+fog/2);
comp_42=`//ret = GetPixel(uv);
comp_43=`}
